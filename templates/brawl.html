{% extends 'base.html' %}


{% block title %}
Brawl
{% endblock %}


{% block style %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/brawl.css') }}">
{% endblock %}


{% block javascript %}
<script src="{{ url_for('static', filename='js/popper.js') }}"></script>
<script src="{{ url_for('static', filename='js/brawl.js') }}"></script>
{% endblock %}


{% block content %}

<!-- Begin character add form -->
<div class="container">
  <form action='/brawl_add_character' method='POST'>

    <div class="form-row">

      <div class="col-3">
        <input type="text" name="name" class="form-control" placeholder="Name" required>
      </div>

      <div class="col-3">
        <input type="text" name="initiative_modifier" class="form-control" placeholder="Initiative Modifier (+5)" required>
      </div>

      <div class="col-2">
        <input type="number" name="armor_class" class="form-control" placeholder="Armor Class" required>
      </div>

      <div class="col-2">
        <input type="number" name="hit_points" class="form-control" placeholder="Hit Points" required>
      </div>

      <div class="col-2">
        <button type="submit" class="btn btn-block btn-outline-info">Add</button>
      </div>

    </div>

  </form>

</div>

<hr>
<!-- End character add form -->


<!-- Begin brawl buttons -->
<div class="container">

  <div class="container">

    <div class="form-row">

      <div class="col-4">
        <button type="button" class="btn btn-block btn-warning" onclick="window.location='/brawl_clear_monsters';">Clear Monsters</button>
      </div>

      <div class="col-4">
        <button type="button" class="btn btn-block btn-danger" onclick="window.location='/brawl_clear_all';">Clear All</button>
      </div>

      <div class="col-4">
        <button type="button" class="btn btn-block btn-primary" onclick="window.location='/brawl_roll_initiative';">Roll Initiative</button>
      </div>

    </div>

  </div>

</div>
<hr>
<!-- End brawl buttons -->


<div class="container">

  <!-- Begin brawl table -->
  <table id="table" class="table table-striped" style="width:100%">

    <tr>
      <th></th>
      <th>Initiative</th>
      <th>Name</th>
      <th>Armor</th>
      <th>Hit Points</th>
      <th>Notes</th>
      <th><center>Conditions</center></th>
      <th><center>Edit</center></th>
    </tr>

    {% for monster in monsters %}
    <tr>
      <td>
        <form action="/brawl_set_turn" method="POST">
          <input name="unique_id" value="{{ monster.unique_id }}"
            type="radio" {% if monster.my_turn == true %}checked="checked"{% endif %}>
        </form>
      </td>

      <td>{{ monster.initiative }}</td>

      <td>
        {% if monster.is_character %}
          {{ monster.name }}
        {% else %}
          <a target='_blank' href='/monster/{{ monster.slug_name }}'>{{ monster.name }}</a>
        {% endif %}
      </td>

      <td>{{ monster.armor_class }}</td>

      <td>{{ monster.hit_points }}</td>

      <td><p>{{ monster.notes }}</p></td>

      <td>
        <center>
          {% if monster.conditions %}<img data-toggle="popover" title="Conditions"
            data-content="
              {% for condition in monster.conditions %}
                <a target='_blank' href='https://roll20.net/compendium/dnd5e/Conditions#h-{{ condition|title }}'>{{ condition|title }}</a>
                {% if not loop.last %}, {% endif %}
              {% endfor %}"
            width=35 src='{{ url_for('static', filename='images/eye.png') }}'>{% endif %}
          </center>
        </td>

      <td>
        <center>
          <a data-toggle="modal" data-target="#{{ monster.unique_id }}_edit">
            <img width=25 src='{{ url_for('static', filename='images/pencil.png') }}'>
          </a>
        </center>
      </td>

    </tr>

    {% endfor %}

  </table>
  <!-- End brawl -->


<!-- Begin brawl modals -->
{% for monster in monsters %}

<div class="modal fade" id="{{ monster.unique_id }}_edit" tabindex="-1" role="dialog"
  aria-labelledby="{{ monster.unique_id }}_edit" aria-hidden="true">

  <div class="modal-dialog" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <h2 class="modal-title" id="{{ monster.unique_id }}_label">{{ monster.name }}</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <form action='/brawl_update_monster' method='POST'>
      <div class="modal-body">

        <input type="hidden" name="unique_id" value="{{ monster.unique_id }}">

        <p><strong>Initiative</strong></p>
        <p><input id="name" class="form-control" type="number"
          value="{{ monster.initiative }}" name="initiative" required></p>

        <p><strong>Armor Class</strong></p>
        <p><input id="ac" class="form-control" type="text" name="armor_class"
          value="{{ monster.armor_class }}" required></p>

        <p><strong>Hit Points</strong></p>
        <p><input id="hp" class="form-control" type="text" name="hit_points"
          value="{{ monster.hit_points }}" required></p>

        <p><strong>Notes</strong></p>
        <p><input id="notes" class="form-control" type="text" name="notes"
          value="{{ monster.notes }}"></p>

        <!-- Begin conditions -->
        <p>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="blinded"
              name="blinded" {% if 'blinded' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Blinded</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="charmed"
              name="charmed" {% if 'charmed' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Charmed</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="deafened"
              name="deafened" {% if 'deafened' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Deafened</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="fatigued"
              name="fatigued" {% if 'fatigued' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Fatigued</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="frightened"
              name="frightened" {% if 'frightened' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Frightened</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="grappled"
              name="grappled" {% if 'grappled' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Grappled</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="incapacitated"
              name="incapacitated" {% if 'incapacitated' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Incapacitated</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="invisible"
              name="invisible" {% if 'invisible' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Invisible</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="paralyzed"
              name="paralyzed" {% if 'paralyzed' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Paralyzed</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="petrified"
            name="petrified" {% if 'petrified' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Petrified</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="poisoned"
              name="poisoned" {% if 'poisoned' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Poisoned</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="prone"
              name="prone" {% if 'prone' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Prone</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="restrained"
              name="restrained" {% if 'restrained' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Restrained</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="stunned"
              name="stunned" {% if 'stunned' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Stunned</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="unconscious"
              name="unconscious" {% if 'unconscious' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Unconscious</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" value="exhaustion"
              name="exhaustion" {% if 'exhaustion' in monster.conditions %}checked{% endif %}>
            <label class="form-check-label">Exhaustion</label>
          </div>
        </p>
        <!-- End conditions -->

      </div>

      <!-- Begin model footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-dark" data-dismiss="modal">Close</button>
        <a class="btn btn-danger" href="/brawl_remove_monster?unique_id={{ monster.unique_id }}">Remove</a>
        <button type="submit" class="btn btn-primary">Save</button>
      </div>
      <!-- End model footer -->

      </form>
    </div>
  </div>
</div>
{% endfor %}
<!-- End brawl modals -->

</div>

{% endblock %}
